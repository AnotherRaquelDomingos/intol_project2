<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Decentralized Finance</title>
  <script src="https://cdn.jsdelivr.net/npm/web3@1.9.0/dist/web3.min.js"></script>
</head>

<body>
  <button onclick="connectMetaMask()">Connect MetaMask</button>

  <br/><br/>

  <div id="newLoanEventNotification" style="display: none;">
    New loan has been created.
  </div>

  <br/><br/>

  <button onclick="getEthTotalBalance()">Get Contract Balance:</button>
  <text id="contractBalance"></text>

  <br/><br/>

  <button onclick="getTotalBorrowedAndNotPaidBackEth()">Get total borrowed and not paid back ETH:</button>
  <text id="getTotalBorrowedAndNotPaidBackEth"></text>

  <br/><br/>
  
  <label for="dexSwapRate">DexSwapRate:</label>
  <input type="text" id="dexSwapRate" name="dexSwapRate" placeholder="Enter dexSwapRate" />
  <button onclick="setRateEthToDex(document.getElementById('dexSwapRate').value)">Set DexSwapRate</button>

  <br/>

  <label for="getDexSwapRate">Current DexSwapRate Value:</label> 
  <text id="getDexSwapRate"></text>

  <br/><br/>

  <label for="totalDEX">Current DEX total balance:</label> 
  <text id="totalDEX"></text>

  <br/>

  <label for="buyDEX">Wei Value:</label>
  <input type="text" id="buyDEX" name="buyDEX" placeholder="Enter Wei value" />
  <button onclick="buyDex(document.getElementById('buyDEX').value)">Buy DEX</button>

  <br/>

  <label for="sellDEX">Dex Amount:</label>
  <input type="text" id="sellDEX" name="sellDEX" placeholder="Enter DEX amount" />
  <button onclick="sellDex(document.getElementById('sellDEX').value)">Sell DEX</button>

  <br/><br/>

  <label for="createLoanDEX">Dex Amount:</label>
  <input type="text" id="createLoanDEX" name="createLoanDEX" placeholder="Enter DEX amount" />
  <br/>
  <label for="createLoanDeadline">Deadline:</label>
  <input type="text" id="createLoanDeadline" name="createLoanDeadline" placeholder="Enter deadline" />
  <button onclick="loan(document.getElementById('createLoanDEX').value, document.getElementById('createLoanDeadline').value)">Loan</button>

  <br/><br/>

  <label for="requestLoanNftContract">NFT Contract:</label>
  <input type="text" id="requestLoanNftContract" name="requestLoanNftContract" placeholder="Enter NFT contract" />
  <br/>
  <label for="requestLoanNftID">NFT ID:</label>
  <input type="text" id="requestLoanNftID" name="requestLoanNftID" placeholder="Enter NFT ID" />
  <br/>
  <label for="requestLoanNftAmount">Loan Amount:</label>
  <input type="text" id="requestLoanNftAmount" name="requestLoanNftAmount" placeholder="Enter loan amount" />
  <br/>
  <label for="requestLoanNftDeadline">Deadline:</label>
  <input type="text" id="requestLoanNftDeadline" name="requestLoanNftDeadline" placeholder="Enter deadline" />
  <button onclick="makeLoanRequestByNft(document.getElementById('requestLoanNftContract').value, 
          document.getElementById('requestLoanNftID').value, document.getElementById('requestLoanNftAmount').value,
          document.getElementById('requestLoanNftDeadline').value)">Request Loan by NFT</button>

  <br/><br/>

  <label for="cancelLoanNftContract">NFT Contract:</label>
  <input type="text" id="cancelLoanNftContract" name="cancelLoanNftContract" placeholder="Enter NFT contract" />
  <br/>
  <label for="cancelLoanNftID">NFT ID:</label>
  <input type="text" id="cancelLoanNftID" name="cancelLoanNftID" placeholder="Enter NFT ID" />
  <button onclick="cancelLoanRequestByNft(document.getElementById('cancelLoanNftContract').value, 
          document.getElementById('cancelLoanNftID').value)">Cancel Loan by NFT</button>

  <br/><br/>

  <label for="loanNftContract">NFT Contract:</label>
  <input type="text" id="loanNftContract" name="loanNftContract" placeholder="Enter NFT contract" />
  <br/>
  <label for="loanNftID">NFT ID:</label>
  <input type="text" id="loanNftID" name="loanNftID" placeholder="Enter NFT ID" />
  <button onclick="loanByNft(document.getElementById('loanNftContract').value, document.getElementById('loanNftID').value)">Loan by NFT</button>

  <br/><br/>

  <label for="returnLoanID">Loan ID:</label>
  <input type="text" id="returnLoanID" name="returnLoanID" placeholder="Enter loan ID" />
  <br/>
  <label for="returnLoanWeiValue">Wei Value:</label>
  <input type="text" id="returnLoanWeiValue" name="returnLoanWeiValue" placeholder="Enter Wei value" />
  <button onclick="returnLoan(document.getElementById('returnLoanID').value, 
                              document.getElementById('returnLoanWeiValue').value)">Return Loan</button>
                              
  <br/><br/>

  <div id="imagesNFTS"></div>

  

  <script> 
    window.onload =  function(){
      getRateEthToDex();
      getDex();
      listenToLoanCreation();
      setInterval(checkLoan, 10 * 60 * 1000);
      getAvailableNfts();
    }; 
  </script>
  <script src="main.js" type="module"></script>
</body>

</html>
